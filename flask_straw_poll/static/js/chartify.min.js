(function(e){var f={max:function(){var j=parseFloat(this[0]);for(var k=1;k<this.length;k++){if(parseFloat(this[k])>j){j=parseFloat(this[k])}}return j},min:function(){var k=parseFloat(this[0]);for(var j=1;j<this.length;j++){if(parseFloat(this[j])<k){k=parseFloat(this[j])}}return k},sum:function(){var k=0;for(var j=0;j<this.length;j++){k=k+parseFloat(this[j])}return k},range:function(l,j,m){for(var k=l;l+k*m<=j;k++){this[k]=l+k*m}return this},round:function(j){var l=1;for(var k=0;k<j;k++){l=l*10}arr=[];jQuery.extend(arr,f);for(var k=0;k<this.length;k++){arr[k]=Math.round(l*this[k])/l}return arr},appendEach:function(k){for(var j=0;j<this.length;j++){this[j]=this[j].toString()+k}return this},first:function(k){var k=k||1;var j=[];jQuery.extend(j,f);for(var l=0;l<Math.min(this.length,k);l++){j[l]=this[l]}return j},last:function(k){var k=k||1;var j=[];jQuery.extend(j,f);for(var l=0;l<Math.min(this.length,k);l++){j[l]=this[this.length-1-l]}return j},toPercentages:function(){var j=[];jQuery.extend(j,f);var l=this.sum();for(var k=0;k<this.length;k++){j[k]=100*this[k]/l}return j}};jQuery.extend(String.prototype,{toString:function(){return this}});var c={chartWidth:496,chartHeight:180,marginTop:0,marginRight:0,marginBottom:0,marginLeft:0,legendWidth:0,legendHeight:0,pieChartRotation:0,unit:"",textSize:11,textColor:"666666",colors:["ff9daa","ffc000","007ec6","433840","6cc05c","ff710f","ED1F27","95a8ad","0053aa"],xAxisBoundaries:"auto",xAxisStep:"auto",axisTickSize:5,showLabels:true,showLegend:true,legendPosition:"",isStacked:false,isDistribution:false,barWidth:20,barSpacing:2,groupSpacing:10,imageClass:""};var b={settings:function(j){if(j){e.extend(c,j);return this.each(function(){})}else{return c}},pie:function(k){var j=g(k);return this.each(function(){var n=e(this);var o=n.chartifyTableData({isDistribution:j.isDistribution});var l=o.getCaption();var m={cht:j.chartType?j.chartType:"p",chs:""+j.chartWidth+"x"+j.chartHeight,chp:j.pieChartRotation,chdlp:j.legendPosition,chdls:j.textColor+","+j.textSize,chts:j.textColor+","+j.textSize,chma:""+j.marginLeft+","+j.marginRight+","+j.marginTop+","+j.marginBottom+"|"+j.legendWidth+","+j.legendHeight};m.chd="t:"+o.toString(",","|");if(j.showTitle){m.chtt=l}if(j.showLegend){m.chdl=o.getValueRowHeaders().round(1).appendEach(j.unit).join("|")}if(j.showLabels){m.chl=o.getColumnHeaders().join("|")}if(j.colors){m.chco=j.colors.first(o.numColumns)}params=i(m);n.after('<img class="'+j.imageClass+'" src="http://chart.apis.google.com/chart?'+params+'" width="'+j.chartWidth+'" height="'+j.chartHeight+'" alt="'+l+'" />');n.attr("style","position: absolute; left: -9999px;")})},bar:function(k){var j=g(k);return this.each(function(){var x=e(this);var C=x.chartifyTableData(j);var w=C.getCaption();var q=!j.isStacked&&C.numRows>1;var n=q?C.numRows:1;var r=j.barWidth*n+j.barSpacing*(n-1);var p=j.showLegend&&j.legendPosition.match(/^(b|t)/)?2:1;var s;if(q){s=r*C.numColumns+j.groupSpacing*(C.numColumns-1)+p*20+j.textSize}else{s=C.numColumns*(r+j.barSpacing)-j.barSpacing+p*20+j.textSize}var B={chxs:"0,"+j.textColor+","+j.textSize+",0,lt,"+j.textColor+"|0,"+j.textColor+","+j.textSize+",0,lt,"+j.textColor,chxt:"x,y",cht:q?"bhg":"bhs",chs:""+j.chartWidth+"x"+s,chxtc:"0,"+j.axisTickSize+"|1,"+j.axisTickSize,chdlp:j.legendPosition,chdls:j.textColor+","+j.textSize,chbh:j.barWidth.toString()+","+j.barSpacing+","+j.groupSpacing,chma:""+j.marginLeft+","+j.marginRight+","+j.marginTop+","+j.marginBottom+"|"+j.legendWidth+","+j.legendHeight};B.chd="t:"+C.toString(",","|");if(j.showTitle){B.chtt=w}if(j.colors){B.chco=j.colors.first(C.numRows).join(",")}if(j.showLabels){var y="";for(var t=0;t<C.numRows;t++){if(t>0){y+="|"}y+="N*0*"+j.unit+","+j.textColor+","+t+",-1,"+j.textSize+",0,r:-3:0"}B.chm=y}if(j.showLegend){B.chdl=C.getRowHeaders().join("|")}var u,z,v;if(j.xAxisBoundaries=="auto"){z=0;u=Math.round(C.getMax(j));var l=j.isStacked&&j.isDistribution?0:1;v=j.xAxisStep=="auto"?h(z,u):j.xAxisStep;u+=l*v}else{z=j.xAxisBoundaries[0];u=j.xAxisBoundaries[1];v=j.xAxisStep=="auto"?h(z,u):j.xAxisStep}var m=d(z,u,v);var o=C.getColumnHeaders().reverse();var A=m[m.length-1];if(j.unit){m=m.appendEach(j.unit)}B.chxl="0:|"+m.join("|")+"|1:|"+o.join("|");B.chxr="0,0,"+A+"|1,0,0";B.chds="0,"+A;params=i(B);x.after('<img class="'+j.imageClass+'" src="http://chart.apis.google.com/chart?'+params+'" width="'+j.chartWidth+'" height="'+s+'" alt="'+w+'" />');x.attr("style","position: absolute; left: -9999px;")})},venn:function(k){var j=g(k);return this.each(function(){var o=e(this);var p=o.chartifyTableData();var m=p.getCaption();var l=p.getMax();var n={chs:""+j.chartWidth+"x"+j.chartHeight,cht:"v",chdlp:j.legendPosition,chdls:j.textColor+","+j.textSize,chma:""+j.marginLeft+","+j.marginRight+","+j.marginTop+","+j.marginBottom+"|"+j.legendWidth+","+j.legendHeight};n.chd="t:"+p.toString(",","|");if(j.colors){n.chco=j.colors.first(p.numColumns).join(",")}if(j.showLegend){n.chdl=p.getColumnHeaders().join("|")}var q=i(n);o.after('<img class="'+j.imageClass+'" src="http://chart.apis.google.com/chart?'+q+'" width="'+j.chartWidth+'" height="'+j.chartHeight+'" alt="'+m+'" />');o.attr("style","position: absolute; left: -9999px;")})},gender:function(k){var j=g(k);e.extend(j,{chartWidth:480,chartHeight:200,numCols:20,numRows:5});return this.each(function(){var x=e(this);var r=x.chartifyTableData({isDistribution:true});var v=r.getColumnData("men").round(0)[0];var u=Math.round(v/j.numRows);var p=v%j.numRows;var o=p==0?j.numCols-u:j.numCols-u-1;var q=(100-v)%j.numRows;var s=Math.round(j.chartWidth/j.numCols);var n=Math.round(j.chartHeight/j.numRows);var w=j.chartWidth-s*u;var m="#"+j.colors[0];var l="#"+j.colors[1];var t=[];t.push('<div class="gender-map" style="position:relative;width:'+j.chartWidth+"px;height:"+j.chartHeight+'px">');t.push('<div class="men" style="position:absolute; left:0; background-color: '+m+"; top:0;width: "+s*u+"px;height: "+j.chartHeight+'px"></div>');if(p>0){w-=s;t.push('<div class="men" style="position:absolute; background-color: '+m+";top: 0; left: "+s*u+"px;width: "+s+"px;height: "+p*n+'px"></div>');t.push('<div class="women" style="position:absolute; background-color: '+l+"; top:"+menRest*n+"px; left: "+s*u+"px;width :"+s+"px;height :"+n*q+'px"></div>')}t.push('<div class="women" style="position:absolute; background-color: '+l+"; right:0; top: 0;width :"+w+"px;height :"+n*j.numRows+'px"></div>');t.push("</div>");x.after(t.join(""));x.attr("style","position: absolute; left: -9999px;")})}};function d(l,m,k){var j=[];e.extend(j,f);return j.range(l,m,k)}function h(k,l){var j=l-k;if(j<=60){return 5}else{if(j<=120){return 10}else{return 25}}}function i(k){var l=[];for(var j in k){l.push(j+"="+encodeURIComponent(k[j]))}return l.join("&")}function g(j){var k=e.extend({},c);if(j){e.extend(k,j)}e.extend(k.colors,f);return k}function a(l,j){var k={isStacked:false,isDistribution:false};if(j){e.extend(k,j)}this.table=e(l);this.caption=this.table.find("caption").html()||"";this.numRows=0;this.numColumns=0;this.rows={};this.rowHeaders=[];this.columnHeaders=[];this.verboseColumnHeaders={};this.initColumns();this.initRows(k)}a.prototype={initColumns:function(){var j={};var k=[];this.table.find("thead th").each(function(m,n){var o=e(n).html();if(o.length>0){var l=e(n).attr("abbr");if(!l){l=o}j[l]=o;k.push(l)}});this.verboseColumnHeaders=j;this.columnHeaders=k;this.numColumns=this.columnHeaders.length;return this},initRows:function(l){var l=l||{};var n={};var k=[];this.table.find("tbody tr").each(function(q,r){var p=[];jQuery.extend(p,f);e(r).find("td").each(function(u,t){p.push(parseFloat(e(t).html()))});if(!l.isStacked&&l.isDistribution){p=p.toPercentages()}var s=e(r).find("th").html()||"data";k.push(s);n[s]=p});if(l.isStacked&&l.isDistribution){for(var j=0;j<this.numColumns;j++){var m=0;for(var o=0;o<k.length;o++){m+=n[k[o]][j]}for(var o=0;o<k.length;o++){n[k[o]][j]=100*n[k[o]][j]/m}}}this.rowHeaders=k;this.rows=n;this.numRows=this.rowHeaders.length;return this},toString:function(k,m){var j=[];jQuery.extend(j,f);for(var l in this.rows){j.push(this.rows[l].round(1).join(k))}return j.join(m)},getMax:function(k){var k=k||{};if(k.isStacked){var o=0;for(var m=0;m<this.numColumns;m++){var n=0;for(var l in this.rows){n+=this.rows[l][m]}if(n>o){o=n}}return o}else{var m=0;var o;for(var l in this.rows){var j=this.rows[l].max();if(m==0){o=j}else{if(j>o){o=j}}m++}return o}},getColumnHeaders:function(){return this.columnHeaders},getRowHeaders:function(){return this.rowHeaders},getValueRowHeaders:function(){return this.rows[this.rowHeaders[0]]},getColumnHeadersIndices:function(){var k={};for(var j=0;j<this.numColumns;j++){k[this.columnHeaders[j]]=j}return k},getColumnData:function(l){for(var j=0;j<this.numColumns;j++){if(this.columnHeaders[j]==l){break}}var k=[];jQuery.extend(k,f);for(key in this.rows){k.push(this.rows[key][j])}return k},getCaption:function(){return this.caption}};e.fn.chartify=function(j){if(b[j]){return b[j].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof j==="object"||!j){return b.init.apply(this,arguments)}else{e.error("Method "+j+" does not exist on jQuery.chartify")}}};e.fn.chartifyTableData=function(j){return new a(e(this),j)}})(jQuery);